{"version":3,"sources":["../es6/tile.js"],"names":[],"mappings":"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","file":"tile.js","sourcesContent":["class Tile { // TODO TileRegistry - where tiles are created and can be looked up and changed\r\n\t\t\t // TODO one registry per row - have them also store the main tile?\r\n\tconstructor(value, parentSelector, size=\"100%\") {\r\n\r\n\t\tUtils.assert(typeof value === \"string\", \"Invalid parameter: value\" + ((value !== undefined) ? ` (${value})` : \"\"));\r\n\t\tUtils.assert($(parentSelector).length > 0, \"Invalid parameter: parentSelector\" + ((parentSelector !== undefined) ? ` (${parentSelector})` : \"\"));\r\n\t\tUtils.assert($(parentSelector).length === 1, `Invalid parentSelector (too many matches): ${parentSelector}`);\r\n\r\n\t\tvar valueRegex = /^([^\\d\\s]*)\\s?(\\d+(?:(\\/|\\^)\\d+)?)$/.exec(value);\r\n\r\n\t\tUtils.assert(valueRegex !== null, `Invalid parameter: value (${value})`);\r\n\r\n\t\tvar operatorPart = valueRegex[1];\r\n\t\tvar valuePart = valueRegex[2];\r\n\t\tvar typePart = valueRegex[3];\r\n\r\n\t\tthis.value = valuePart;\r\n\r\n\t\tif (operatorPart !== \"\") {\r\n\t\t\tUtils.assert(Tile._isOperator(operatorPart), `Invalid operation in value: ${operatorPart}`);\r\n\t\t\tthis.operation = Tile.operations[operatorPart];\r\n\t\t}\r\n\t\telse this.operation = undefined;\r\n\r\n\t\tvar isInteger = typePart === undefined;\r\n\r\n\t\ttry { math.parse(this.value); }\r\n\t\tcatch(e) { throw `Cannot parse math: ${value}`; }\r\n\r\n\t\tthis.parentSelector = parentSelector;\r\n\t\tthis.size = size;\r\n\r\n\t\tthis.$element = $(\"<div>\").addClass(\"tile\");\r\n\t\tif (this.operation !== undefined) this.$element.attr(\"data-operation\", this.operation);\r\n\t\tthis.element = this.$element.get(0);\r\n\r\n\t\tvar mathNode = math.parse(this.value);\r\n\t\tthis.computedValue = mathNode.compile().eval();\r\n\t\tthis.$element.attr(\"data-value\", this.computedValue);\r\n\r\n\t\tif (isInteger) this.$element.html($(\"<div>\").addClass(\"math\").text(this.value));\r\n\t\telse {\r\n\t\t\tvar tex = mathNode.toTex({parenthesis: \"auto\"});\r\n\t\t\tthis.element.innerHTML = `$$ ${tex} $$`;\r\n\t\t}\r\n\t\t\r\n\t\tthis.$element.hide().appendTo($(this.parentSelector)).fadeIn(250);\r\n\r\n\t\tthis.$element.outerHeight(this.size);\r\n\t\tthis.$element.remove().appendTo($(this.parentSelector));\r\n\t\tthis.$element.outerWidth(this.$element.outerHeight());\r\n\r\n\t\tif (!isInteger) {\r\n\t\t\tMathJax.Hub.Queue([\"Typeset\", MathJax.Hub, this.element],\r\n\t\t\t\t() => Utils.scaleToFit(this.$element, \".math\", .9));\r\n\t\t}\r\n\t\telse Utils.scaleToFit(this.$element, \".math\");\r\n\t}\r\n\r\n\tstatic _isOperator(op) {\r\n\t\treturn Tile.operations.hasOwnProperty(op);\r\n\t}\r\n}\r\n\r\nTile.operations = {\r\n\t\"+\": \"+\",\r\n\tplus: \"+\",\r\n\tadd: \"+\",\r\n\taddition: \"+\",\r\n\r\n\t\"-\" : \"-\",\r\n\tsub: \"-\",\r\n\tsubtract: \"-\",\r\n\tminus: \"-\",\r\n\r\n\t\"*\": \"*\",\r\n\ttimes: \"*\",\r\n\tmulti: \"*\",\r\n\tmultiply: \"*\"\r\n\r\n};"]}