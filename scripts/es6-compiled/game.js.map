{"version":3,"sources":["../es6/game.js"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["class Game {\r\n\tconstructor() {\r\n\t\tthis.registry = new TileRegistry(\".bigTileArea\");\r\n\t\tthis.registry.addGroup(\"row1\", \".tileRow1\");\r\n\t\tthis.registry.addGroup(\"row2\", \".tileRow2\");\r\n\t\tthis.registry.addGroup(\"row3\", \".tileRow3\");\r\n\r\n\t\tthis.display = new Display(this.registry, 30, {fill:\"black\",stroke:\"white\"});\r\n\r\n\t\tthis.difficultyData = $.extend(true, [], DIFFICULTY_DATA);\r\n\r\n\t\tthis.playing = false;\r\n\r\n\t\tthis.display.fader.onEnd = () => { this.nextLevel(); };\r\n\t}\r\n\r\n\tstartRound(diff) {\r\n\t\tvar options = this.difficultyData[diff].options;\r\n\t\tthis.current = {diff, options};\r\n\t\tthis.nextLevel();\r\n\t\tthis.playing = true;\r\n \t}\r\n\r\n\tnextLevel() {\r\n\t\tif (this.playing) {\r\n\t\t\tthis.registry.generateTiles(this.current.diff);\r\n\t\t\tthis.display.startCountdown(this.current.options.timeLimit);\r\n\t\t}\r\n\t}\r\n\r\n\tchooseRow(rowNumber) {\r\n\r\n\t\tvar rowName = \"row\"+rowNumber;\r\n\r\n\t\tthis.display.blinkArrow(\"lightgray\", rowNumber);\r\n\r\n\t\tif (this.playing) {\r\n\t\t\tif (this.registry.isMaxGroup(rowName)) {\r\n\t\t\t\tthis.display.blinkRow(\"green\", rowNumber);\r\n\t\t\t\tthis.nextLevel();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.display.blinkRow(\"red\", rowNumber);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Display {\r\n\tconstructor(registry, barSegmentCount, arrowColors) {\r\n\r\n\t\tthis.registry = registry;\r\n\t\tthis.barSegmentCount = barSegmentCount;\r\n\t\tthis.barArea = undefined;\r\n\t\tthis.fader = new DisplayFader(this);\r\n\r\n\t\tthis.arrowColors = arrowColors;\r\n\r\n\t\tthis.init();\r\n\r\n\t}\r\n\r\n\tinit() {\r\n\t\tthis.fader.stop();\r\n\t\tthis.initBar();\r\n\t\tthis.initHighlights();\r\n\t\tthis.initArrows();\r\n\t}\r\n\r\n\tinitBar() {\r\n\t\tthis.barArea = $(\"#barArea\").get(0);\r\n\t\t$(this.barArea).find(\".barSegment\").remove();\r\n\t\tvar eachWidth = $(this.barArea).width() / this.barSegmentCount;\r\n\t\tfor (var i=0; i < this.barSegmentCount; i++) {\r\n\t\t\t$(this.barArea).append($(\"<div>\").addClass(\"barSegment\").width(eachWidth))\r\n\t\t}\r\n\t}\r\n\r\n\tinitHighlights() {\r\n\t\tUtils.forEachIn((k, group) => {\r\n\t\t\t\t$(group.parentSelector)\r\n\t\t\t\t\t.removeClass(\"selected\")\r\n\t\t\t\t\t.append($(\"<div>\").addClass(\"highlighter\"))\r\n\t\t\t}, this.registry.groups);\r\n\t}\r\n\r\n\tinitArrows() {\r\n\t\tvar rowHeight = $(\".arrow\").parent().height();\r\n\t\t$.get(\"images/arrow.svg\", data => {\r\n\t\t\t$(\".arrow\").html($(data).children())\r\n\t\t\t\t.width(rowHeight)\r\n\t\t\t\t.find(\"polyline\")\r\n\t\t\t\t.attr(\"fill\",   this.arrowColors.fill)\r\n\t\t\t\t.attr(\"stroke\", this.arrowColors.stroke);\r\n\t\t});\r\n\t}\r\n\r\n\tblinkArrow(color, ...rowNumbers) {\r\n\t\trowNumbers.forEach(rowNumber => {\r\n\t\t\t$(this.registry.getGroupEl(\"row\"+rowNumber))\r\n\t\t\t\t.find(\".arrow\").find(\"polyline\")\r\n\t\t\t\t.animate(\r\n\t\t\t\t{svgFill: color},\r\n\t\t\t\t{duration:250, queue:true}\r\n\t\t\t).animate(\r\n\t\t\t\t{svgFill: this.arrowColors.fill},\r\n\t\t\t\t{duration:250, queue:true}\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tblinkRow(color, ...rowNumbers) {\r\n\t\trowNumbers.forEach(rowNumber => {\r\n\t\t\t$(this.registry.getGroupEl(\"row\"+rowNumber)).find(\".highlighter\")\r\n\t\t\t\t.animate(\r\n\t\t\t\t\t{borderColor:color},\r\n\t\t\t\t\t{duration:250, queue:true}\r\n\t\t\t\t).animate(\r\n\t\t\t\t\t{borderColor:\"transparent\"},\r\n\t\t\t\t\t{duration:250, queue:true}\r\n\t\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tstartCountdown(seconds) {\r\n\t\tthis.fader.fade(seconds);\r\n\t}\r\n}\r\n\r\nclass DisplayFader {\r\n\tconstructor(display) {\r\n\t\tthis._display = display;\r\n\t\tthis.current = {};\r\n\t\tthis.$barArea = $(\"#barArea\");\r\n\t\tthis.onEnd = () => {};\r\n\t}\r\n\r\n\tfade(seconds, loop) {\r\n\t\tif (!loop) {\r\n\t\t\tthis.stop();\r\n\t\t\tthis.current.time = seconds;\r\n\t\t}\r\n\r\n\t\tvar speed = seconds / this._display.barSegmentCount;\r\n\t\tthis.current.total = seconds;\r\n\t\tthis.current.speed = speed;\r\n\r\n\t\tvar fader = this;\r\n\r\n\t\tvar $segments = this.$barArea.find(\".barSegment\");\r\n\r\n\t\tif ($segments.length === 0) {\r\n\t\t\tthis.onEnd();\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$segments.last().fadeOut(speed * 1000, function () {\r\n\t\t\t\t$(this).remove();\r\n\t\t\t\tfader.current.time -= speed;\r\n\t\t\t\tfader.fade(seconds, true);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\taddTime(seconds) {\r\n\t\tif (this.current.time + seconds < this.current.total) {\r\n\t\t\tthis.current.time += seconds;\r\n\t\t\tvar barsToAdd = seconds * this.current.speed;\r\n\t\t\tthis.$barArea.append(\r\n\t\t\t\tnew Array(barsToAdd+1).join(\r\n\t\t\t\t\t$(\"<div>\").addClass(\"barSegment\").get(0).outerHTML\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tstop() {\r\n\t\t$(this._display.barArea).find(\".barSegment\").stop();\r\n\t\tthis._display.initBar();\r\n\t}\r\n}"]}