{"version":3,"sources":["../es6/game.js"],"names":[],"mappings":"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","file":"game.js","sourcesContent":["class Game {\n\tconstructor() {\n\t\tthis.registry = new TileRegistry(\".bigTileArea\");\n\t\tthis.registry.addGroup(\"row1\", \".tileRow1\");\n\t\tthis.registry.addGroup(\"row2\", \".tileRow2\");\n\t\tthis.registry.addGroup(\"row3\", \".tileRow3\");\n\n\t\tthis.display = new Display(this.registry, 30);\n\n\t\tthis.difficultyData = $.extend(true, [], DIFFICULTY_DATA);\n\n\t\tthis._timeouts = {};\n\t}\n\n\tstartRound(diff) {\n\t\tvar options = this.difficultyData[diff].options;\n\t\tthis.registry.generateTiles(diff);\n\t\tthis.display.startCountdown(options.timeLimit);\n\t}\n\n\tchooseRow(rowNumber) {\n\n\t\tclearTimeout(this._timeouts.arrowBlink);\n\n\t\tthis.display.deactivateArrow(1,2,3);\n\t\tthis.display.activateArrow(rowNumber);\n\n\t\tthis._timeouts.arrowBlink = setTimeout(() => {\n\t\t\tthis.display.deactivateArrow(rowNumber);\n\t\t}, 500);\n\n\t\t// TO-DO this is not a good way to do this - more js and less css\n\t\t//$(this.registry.groups[\"row\"+rowNumber].parentSelector).addClass(\"highlight green\");\n\t}\n}\n\nclass Display {\n\tconstructor(registry, barSegmentCount) {\n\n\t\tthis.registry = registry;\n\t\tthis.barSegmentCount = barSegmentCount;\n\t\tthis.barArea = undefined;\n\t\tthis.fader = new DisplayFader(this);\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\t\tthis.initBar();\n\t\tthis.initHighlights();\n\t\tthis.initArrows();\n\t}\n\n\tinitBar() {\n\t\tthis.barArea = $(\"#barArea\").get(0);\n\t\t$(this.barArea).find(\".barSegment\").remove();\n\t\tfor (var i=0; i < this.barSegmentCount; i++) {\n\t\t\t$(this.barArea).append($(\"<div>\").addClass(\"barSegment\"))\n\t\t}\n\t}\n\n\tinitHighlights() {\n\t\tUtils.forEachIn((k, group) =>\n\t\t\t{ $(group.parentSelector)\n\t\t\t\t.append($(\"<div>\").addClass(\"highlighter\"))\n\t\t\t\t.on(\"animationend\", function() {\n\t\t\t\t\t$(this).removeClass(\"highlight red green\");\n\t\t\t})},\n\t\t\tthis.registry.groups);\n\t}\n\n\tinitArrows() {\n\t\tvar rowHeight = $(\".arrow\").parent().height();\n\t\t$.get(\"images/arrow.svg\", function(data) {\n\t\t\t$(\".arrow\").html($(data).children()).width(rowHeight);\n\t\t});\n\t}\n\n\tactivateArrow(...rowNumbers) { // TODO allow for varargs for multiple rows\n\t\trowNumbers.forEach(rowNumber => {\n\t\t\t$(this.registry.getGroupEl(\"row\"+rowNumber)).find(\".arrow\").addClass(\"active\");\n\n\t\t});\n\t}\n\n\tdeactivateArrow(...rowNumbers) {\n\t\trowNumbers.forEach(rowNumber => {\n\t\t\t$(this.registry.getGroupEl(\"row\"+rowNumber)).find(\".arrow\").removeClass(\"active\");\n\t\t});\n\t}\n\n\tstartCountdown(seconds) {\n\t\tthis.fader.fade(seconds);\n\t}\n}\n\nclass DisplayFader {\n\tconstructor(display) {\n\t\tthis._display = display;\n\t}\n\n\tfade(seconds, loop) {\n\t\tif (!loop) this.stop();\n\t\tvar speed = seconds / this._display.barSegmentCount;\n\t\tvar fader = this;\n\t\t$(this._display.barArea).find(\".barSegment:last-child\")\n\t\t.fadeOut(speed*1000, function() {\n\t\t\t\t$(this).remove();\n\t\t\t\tfader.fade(seconds, true);\n\t\t\t});\n\t}\n\n\tstop() {\n\t\t$(this._display.barArea).find(\".barSegment\").stop();\n\t\tthis._display.initBar();\n\t}\n}"]}